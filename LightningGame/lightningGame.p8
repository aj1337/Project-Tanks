pico-8 cartridge // http://www.pico-8.com
version 29
__lua__

basket_sprite=1
player_sprite=2

player_x=64
player_y=100
player_speed = 2

fruits={}
fruit_start=16
fruit_count=6
fruit_interval=16

gravity=1
level=1
points=0

function _init()
    for i=1,level do
        fruit={ --fruits table contains sprite, x,y for each tuple
            sprite=flr(rnd(fruit_count)+fruit_start),
            x=flr(rnd(120)+5), --randomly place fruit on screen 
            y=i*(-fruit_interval)
        }
        add(fruits,fruit)
    end


end

function _update()
    if btn(0) then player_x-=player_speed end
    if btn(1) then player_x+=player_speed end

    for fruit in all(fruits) do --iterate through fruits table 
        fruit.y+=gravity --increase the y value of gravity so the fruits fall

        if  fruit.y+4>=player_y-8--if fruit enters basket check
        and fruit.y+4<=player_y
        and fruit.x+4>=player_x
        and fruit.x+4<=player_x+8 then
            points+=1 -- increment points if catch fruit
            del(fruits,fruit) -- delete fruit when hit basket
                if fruit.sprite == 16 then -- if the fruit is green sprite increase player speed 
                    player_speed = player_speed +2
    end
        end



        if fruit.y>100 then --if fruits hit floor
            del(fruits,fruit) --delete fruit 
            points = points -1 -- subtract points from player
            if fruit.sprite == 16 then 
                points = points -5
            end
        end
    end


    if #fruits==0 then
        level+=1
        _init()
    end
end

function _draw()
    cls()
    rectfill(0,108,127,127,4) -- draw floor
    spr(player_sprite,player_x,player_y) --draw player
    spr(basket_sprite,player_x,player_y-8) --draw basket

    for fruit in all(fruits) do --draw fruits at top screen
        spr(fruit.sprite,fruit.x,fruit.y)--draw from fruit table
    end

    print("score= "..points,1,10,10)
    print("catch 15 fruits to win", 29, 0, 10)

    if points >= 15 then 
    cls()
    print("GAME OVER, YOU WON", 32,60,7)
    stop()
    end

    if points < 0 then 
    cls()
    print("GAME OVER YOU LOST",32,60,8)
    print("too many fruits",32,70,8)
    print("hit the floor",32,80,8)
    stop()
    end
end
__gfx__
00000000666666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000700000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700077777700044440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700066060606f0f7f70f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700060606066f0ffff0f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070066060606fccccccf00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000606060660001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000666666660001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000bb00000bb000000000a000000000000008800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000b0000000b0000000aaa000000000000880830000300000000000000000000000000000000000000000000000000000000000000000000000000000000000
00bbbbb008888880000aa0a000044000008808830003b98000000000000000000000000000000000000000000000000000000000000000000000000000000000
00b367b008b0b08000aa0aa000477400008088300097998000000000000000000000000000000000000000000000000000000000000000000000000000000000
00b336b0088b08800aa0aa000004400000883300009aa98000000000000000000000000000000000000000000000000000000000000000000000000000000000
000bbb000008800000aaa00000000000003330000009988000000000000000000000000000000000000000000000000000000000000000000000000000000000
